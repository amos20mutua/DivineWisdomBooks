<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PruBooks | Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        icy: {
                            light: '#F5FAFF',
                            DEFAULT: '#D6E6F2',
                            dark: '#A9C4D8',
                        },
                        gold: {
                            light: '#F7E7CE',
                            DEFAULT: '#C28811',
                            dark: '#BFA14A',
                        },
                        frost: '#E3EAF2',
                        slate: '#6B7280',
                    },
                    fontFamily: {
                        script: ['Dancing Script', 'cursive'],
                        elegant: ['Playfair Display', 'serif'],
                    },
                    boxShadow: {
                        frost: '0 4px 32px 0 rgba(173, 216, 230, 0.15)',
                    },
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='16' fill='%23C28811'/%3E%3Ctext x='50%' y='56%' text-anchor='middle' font-size='28' font-family='Playfair Display, serif' fill='white' font-weight='bold'%3EPru%3C/text%3E%3C/svg%3E">
    <style>
        .fancy-font { font-family: 'Dancing Script', cursive; }
        .elegant-font { font-family: 'Playfair Display', serif; }
        .frosted {
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(6px);
            border-radius: 1rem;
        }
        .gold-text { color: #C28811; }
        .gold-bg { background-color: #C28811; }
        .gold-border { border-color: #C28811; }
        .navbar-shadow { box-shadow: 0 2px 8px 0 rgba(194, 136, 17, 0.08); }
        .sticky-footer { position: sticky; bottom: 0; left: 0; width: 100%; }
        .mirror-navbar {
            background: rgba(255, 255, 255, 0.35);
            backdrop-filter: blur(18px) saturate(180%);
            -webkit-backdrop-filter: blur(18px) saturate(180%);
            border: 1.5px solid #C28811;
            box-shadow: 0 8px 32px 0 rgba(194,136,17,0.12), 0 2px 8px 0 rgba(255,182,193,0.10);
            border-radius: 1.5rem;
        }
    </style>
</head>
<body class="bg-icy-light min-h-screen flex flex-col relative overflow-x-hidden">
    <!-- Navbar -->
    <nav class="mirror-navbar fixed left-1/2 -translate-x-1/2 top-4 z-20" style="width:70vw;max-width:700px;transform:translate(-50%, -8px);padding-top:0.25rem;padding-bottom:0.25rem;">
        <div class="container flex items-center justify-between px-2 sm:px-4 py-1.5 mx-auto">
            <div class="flex-1 flex justify-center items-center gap-2">
                <span class="text-lg sm:text-xl fancy-font gold-text text-center">PruBooks</span>
            </div>
            <!-- Hamburger Button (mobile) -->
            <button id="hamburgerBtn" type="button" class="md:hidden flex flex-col justify-center items-center w-8 h-8 rounded-full border-2 gold-border bg-gradient-to-br from-pink-200 via-pink-100 to-gold/30 shadow hover:bg-pink-200 transition z-30" aria-label="Open menu">
                <span class="block w-5 h-0.5 bg-gold mb-0.5 rounded transition-all"></span>
                <span class="block w-5 h-0.5 bg-gold mb-0.5 rounded transition-all"></span>
                <span class="block w-5 h-0.5 bg-gold rounded transition-all"></span>
        </button>
            <div class="hidden md:flex flex-1 justify-center gap-4 sm:gap-6 items-center">
                <a href="index.html#home" class="text-slate hover:gold-text font-semibold transition-colors text-xs sm:text-sm">Home</a>
                <a href="contact.html" class="text-slate hover:gold-text font-semibold transition-colors text-xs sm:text-sm">Contact</a>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobileMenu" class="mobile-menu closed md:hidden absolute top-full right-2 w-1/3 min-w-[120px] bg-white/60 z-50 border-b gold-border border-2 transition-all duration-300 overflow-hidden pointer-events-auto rounded-2xl shadow-lg backdrop-blur-lg flex justify-end" style="max-height:0;opacity:0;pointer-events:none;">
            <div class="flex flex-col items-end gap-0.5 py-1.5 px-2 w-full">
                <a href="index.html#home" class="text-slate hover:gold-text font-semibold transition-colors text-xs py-0.5 px-2 rounded-lg bg-white/40 hover:bg-gold/10 shadow-sm w-fit">Home</a>
                <a href="contact.html" class="text-slate hover:gold-text font-semibold transition-colors text-xs py-0.5 px-2 rounded-lg bg-white/40 hover:bg-gold/10 shadow-sm w-fit">Contact</a>
        </div>
      </div>
    </nav>
    <main class="container mx-auto px-2 sm:px-4 py-8 mt-28 flex-1 main-section relative z-10">
        <!-- Shop Section (dynamic, pretty, girly cards) -->
        <section class="mb-16">
            <div class="flex flex-col sm:flex-row gap-4 mb-8 items-center">
                <input type="text" id="searchBar" class="search-bar flex-1 px-4 py-3 rounded-full border border-gold focus:outline-none focus:ring-2 focus:ring-gold elegant-font text-lg" placeholder="Search books...">
                <select id="sortDropdown" class="sort-dropdown px-4 py-3 rounded-full border border-gold focus:outline-none focus:ring-2 focus:ring-gold elegant-font text-lg">
            <option value="default">Sort by</option>
                    <option value="Title: A-Z">Title (A-Z)</option>
                    <option value="Price: Low to High">Price (Low to High)</option>
                    <option value="Price: High to Low">Price (High to Low)</option>
          </select>
                <button class="gold-bg text-white py-2 px-4 sm:py-3 sm:px-6 rounded-full font-bold hover:bg-gold-dark transition flex items-center relative cartCount" onclick="openCart()">
                    <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-pink-300 mr-2 shadow-md">
                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="2.2" viewBox="0 0 24 24" aria-hidden="true"><circle cx="9" cy="21" r="1.5"/><circle cx="19" cy="21" r="1.5"/><path d="M2.5 3h2l2.5 13h11l2.5-8H6.5"/></svg>
                    </span>
                    <span class="ml-1 font-semibold">Cart</span>
                    <span id="cartBadge" class="absolute -top-2 -right-2 bg-pink-400 text-white text-xs font-bold rounded-full px-2 py-0.5 shadow transition-all" style="display:none;">0</span>
          </button>
        </div>
            <div id="bookGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8"></div>
            <div id="showMoreContainer"></div>
        </section>
    <!-- Cart Modal -->
        <!-- Cart modal overlay uses z-index 120 to always appear above sticky footer -->
        <div id="cartModalBg" class="cart-modal-bg fixed inset-0 hidden flex items-end md:items-center justify-center" style="z-index:120;">
            <div class="absolute inset-0" onclick="closeCart()"></div>
            <div class="cart-modal bg-white/80 backdrop-blur-lg w-full max-w-xs sm:max-w-md rounded-3xl shadow-2xl flex flex-col overflow-hidden border-2 gold-border mb-24 sm:mb-[5vh]" style="margin-bottom:6rem;">
                <div class="flex items-center justify-between px-4 sm:px-6 py-4 border-b gold-border border-2 bg-gradient-to-r from-pink-100 via-gold/10 to-pink-200">
                    <span class="font-bold text-base sm:text-lg gold-text">Your Cart</span>
                    <button onclick="closeCart()" class="text-slate hover:text-gold text-2xl">&times;</button>
          </div>
                <div id="cartList" class="flex-1 overflow-y-auto px-4 sm:px-6 py-2"></div>
                <div class="px-4 sm:px-6 py-4 border-t gold-border border-2 flex items-center justify-between bg-white/60">
                    <span class="font-semibold text-slate">Total:</span>
                    <span id="cartTotal" class="font-bold text-gold text-base sm:text-lg">KSh 0</span>
          </div>
                <div class="px-4 sm:px-6 pb-6">
                    <button onclick="checkoutCart()" class="w-full bg-gradient-to-r from-pink-400 via-gold to-pink-300 text-white py-3 rounded-full font-bold hover:from-gold hover:to-pink-400 transition focus:outline-gold-dark focus:ring-2 focus:ring-gold-dark text-base sm:text-lg shadow-lg">Checkout via WhatsApp</button>
          </div>
        </div>
      </div>
    </main>
    <!-- Footer -->
    <footer class="sticky-footer bg-white/80 border-t border-gold py-4 mt-16 flex flex-col sm:flex-row items-center justify-between px-4 shadow-inner" style="position:sticky;bottom:0;left:0;width:100%;z-index:20;">
        <div class="flex items-center gap-2 mb-2 sm:mb-0">
            <span class="fancy-font text-xl gold-text">PruBooks</span>
            <span class="text-slate text-xs">© 2024 Prudence. All rights reserved.</span>
        </div>
        <div class="flex gap-4">
            <a href="#" class="text-pink-400 hover:text-gold transition" title="Instagram" aria-label="Instagram"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5A4.25 4.25 0 0 0 20.5 16.25v-8.5A4.25 4.25 0 0 0 16.25 3.5zm4.25 2.25a6.25 6.25 0 1 1-6.25 6.25 6.25 6.25 0 0 1 6.25-6.25zm0 1.5a4.75 4.75 0 1 0 4.75 4.75A4.75 4.75 0 0 0 12 5.25zm6.5 1.25a1.25 1.25 0 1 1-1.25 1.25A1.25 1.25 0 0 1 18.5 6.5z"/></svg></a>
            <a href="#" class="text-blue-400 hover:text-gold transition" title="Facebook" aria-label="Facebook"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22.675 0h-21.35C.6 0 0 .6 0 1.326v21.348C0 23.4.6 24 1.326 24H12.82v-9.294H9.692v-3.622h3.127V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.797.143v3.24l-1.918.001c-1.504 0-1.797.715-1.797 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116C23.4 24 24 23.4 24 22.674V1.326C24 .6 23.4 0 22.675 0"/></svg></a>
            <a href="#" class="text-pink-500 hover:text-gold transition" title="TikTok" aria-label="TikTok"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12.75 2v14.25a2.25 2.25 0 1 1-2.25-2.25h1.5a.75.75 0 0 0 0-1.5h-1.5A3.75 3.75 0 1 0 15 16.25V8.5a5.25 5.25 0 0 0 5.25 5.25.75.75 0 0 0 0-1.5A3.75 3.75 0 0 1 16.5 8.5V2.75a.75.75 0 0 0-.75-.75h-3a.75.75 0 0 0-.75.75z"/></svg></a>
      </div>
    </footer>
    <script>
    // Hamburger menu logic (copied from homepage)
    document.addEventListener('DOMContentLoaded', function() {
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const mobileMenu = document.getElementById('mobileMenu');
        let menuOpen = false;
        hamburgerBtn.classList.add('cursor-pointer');
        function showMenu() {
          mobileMenu.classList.remove('closed');
          mobileMenu.classList.add('open');
          mobileMenu.style.maxHeight = '';
          mobileMenu.style.opacity = '';
          mobileMenu.style.pointerEvents = '';
        }
        function hideMenu() {
          mobileMenu.classList.remove('open');
          mobileMenu.classList.add('closed');
          mobileMenu.style.maxHeight = '0';
          mobileMenu.style.opacity = '0';
          mobileMenu.style.pointerEvents = 'none';
        }
        hamburgerBtn.addEventListener('click', () => {
          menuOpen = !menuOpen;
          if (menuOpen) {
            showMenu();
          } else {
            hideMenu();
          }
        });
        // Close menu when clicking a link
        mobileMenu.querySelectorAll('a').forEach(link => {
          link.addEventListener('click', () => {
            menuOpen = false;
            hideMenu();
          });
        });
    });
    // Shop logic (fetch from JsonBin, display pretty cards)
    const BIN_ID = '6807cda78a456b79668efaac';
    const API_KEY = '$2a$10$605GyHAIOjLu2gXKIiGX/e2kvNuv3PLVOA01dPgdT8ITrsTGXF8Dy';
    let BOOK_CATALOG = [];
    let CART = [];
    let FILTERED_BOOKS = [];
    
    async function getBookCatalog() {
        try {
            const response = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
                headers: { 'X-Master-Key': API_KEY }
            });
            if (!response.ok) throw new Error('Failed to fetch books');
            const data = await response.json();
            return data.record.books || [];
        } catch (error) {
            console.error('Error fetching books:', error);
            return [];
        }
    }

    function renderBooks(books) {
        const grid = document.getElementById('bookGrid');
        if (!books.length) {
            grid.innerHTML = '<p class="text-center text-slate italic">No books found.</p>';
            return;
        }
        grid.innerHTML = books.map((book, i) => `
            <div class="pretty-card flex flex-col items-center p-3 sm:p-4 transition-transform hover:scale-105 group min-w-0 shadow-frost">
                <img src="${book.image}" alt="${book.title}" class="w-24 h-32 sm:w-32 sm:h-44 object-cover rounded-2xl mb-2 sm:mb-3 border-2 gold-border shadow-md bg-white" loading="lazy">
                <h3 class="fancy-font text-lg sm:text-xl gold-text mb-0.5 sm:mb-1 text-center">${book.title}</h3>
                <p class="elegant-font text-slate text-xs sm:text-sm mb-0.5 sm:mb-1 text-center">by ${book.author}</p>
                <p class="text-pink-500 font-bold text-base sm:text-lg mb-1 sm:mb-2">KSh ${book.price}</p>
                <p class="text-slate text-xs mb-2 sm:mb-3 text-center">${book.description}</p>
                <button onclick="addToCart(${i})" class="gold-bg text-white px-4 py-2 sm:px-6 sm:py-2 rounded-full font-bold hover:bg-gold-dark transition w-full mt-auto text-sm sm:text-base">Add to Cart</button>
            </div>
        `).join('');
    }

    function updateCartCount() {
        const count = CART.length;
        document.querySelectorAll('.cartCount').forEach(el => {
            // nothing here, badge is handled below
        });
        const badge = document.getElementById('cartBadge');
        if (badge) {
            badge.textContent = count;
            badge.style.display = count ? 'inline-block' : 'none';
        }
    }

    function addToCart(index) {
        CART.push(FILTERED_BOOKS[index]);
        updateCartCount();
        showToast('Added to cart!');
    }

    function openCart() {
        const modalBg = document.getElementById('cartModalBg');
        const cartList = document.getElementById('cartList');
        const cartTotal = document.getElementById('cartTotal');
        if (!CART.length) {
            cartList.innerHTML = '<p class="text-center text-slate italic">Your cart is empty.</p>';
            cartTotal.textContent = 'KSh 0';
        } else {
            let total = 0;
            cartList.innerHTML = CART.map((item, i) => {
                total += item.price;
                return `
                    <div class='flex flex-col sm:flex-row items-center gap-3 mb-4 p-3 rounded-2xl shadow-frost border-2 gold-border bg-white/70'>
                        <img src="${item.image}" alt="${item.title}" class="w-16 h-20 object-cover rounded-xl border gold-border shadow-md bg-white mb-2 sm:mb-0">
                        <div class="flex-1 min-w-0">
                            <div class="fancy-font text-base gold-text font-bold mb-1 truncate">${item.title}</div>
                            <div class="elegant-font text-xs text-slate mb-1 truncate">by ${item.author}</div>
                            <div class="text-pink-500 font-semibold text-sm mb-1">KSh ${item.price}</div>
                            <div class="text-xs text-slate mb-1 line-clamp-2">${item.description}</div>
                            <a href="${item.image}" target="_blank" class="text-xs text-blue-500 underline break-all hover:text-gold transition">Image Link</a>
                        </div>
                        <button onclick="removeFromCart(${i})" class="text-red-500 hover:text-red-700 text-lg ml-2 sm:ml-0">&times;</button>
                    </div>
                `;
            }).join('');
            cartTotal.textContent = `KSh ${total}`;
        }
        modalBg.classList.remove('hidden');
    }

    function closeCart() {
        document.getElementById('cartModalBg').classList.add('hidden');
    }

    function removeFromCart(index) {
        CART.splice(index, 1);
        updateCartCount();
        openCart();
    }

    function checkoutCart() {
        if (!CART.length) return;
        const message = encodeURIComponent(
            'Hello! I would like to order the following books:%0A%0A' +
            CART.map(b =>
                `• ${b.title} (KSh ${b.price})\nby ${b.author}\n${b.description}\nImage: ${b.image}\n`
            ).join('%0A') +
            `%0ATotal: KSh ${CART.reduce((sum, b) => sum + b.price, 0)}`
        );
        window.location.href = `https://wa.me/254785881419?text=${message}`;
    }

    function showToast(msg) {
        const toast = document.createElement('div');
        toast.className = 'toast fixed bottom-8 left-1/2 -translate-x-1/2 bg-gold text-white px-6 py-3 rounded-full shadow-lg z-50';
        toast.textContent = msg;
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 2500);
    }

    function filterAndRender() {
        const q = document.getElementById('searchBar').value.toLowerCase();
        let books = BOOK_CATALOG.filter(b =>
            b.title.toLowerCase().includes(q) ||
            b.author.toLowerCase().includes(q) ||
            b.description.toLowerCase().includes(q)
        );
        const sort = document.getElementById('sortDropdown').value;
        if (sort === 'Title: A-Z') books.sort((a, b) => a.title.localeCompare(b.title));
        if (sort === 'Price: Low to High') books.sort((a, b) => a.price - b.price);
        if (sort === 'Price: High to Low') books.sort((a, b) => b.price - a.price);
        FILTERED_BOOKS = books;
        renderBooks(FILTERED_BOOKS);
    }

    document.getElementById('searchBar').addEventListener('input', filterAndRender);
    document.getElementById('sortDropdown').addEventListener('change', filterAndRender);
    window.addToCart = addToCart;
    window.openCart = openCart;
    window.closeCart = closeCart;
    window.removeFromCart = removeFromCart;
    window.checkoutCart = checkoutCart;

    // Initial load
    getBookCatalog().then(books => {
        BOOK_CATALOG = books;
        FILTERED_BOOKS = books;
        renderBooks(books);
        updateCartCount();
    });
    </script>
</body>
</html> 